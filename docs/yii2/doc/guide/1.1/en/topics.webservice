<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    	<meta charset="UTF-8" />
		<meta name="keywords" content="yii framework, tutorial, guide, version 1.1" />
	<meta name="description" content="Web service is a software
system designed to support interoperable machine-to-machine interaction
over a network." />
    <link rel="shortcut icon" type="image/x-icon" href="http://static.yiiframework.com/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="http://static.yiiframework.com/css/site-20130404102234.css" />

	<link title="Lives News for Yii Framework" rel="alternate" type="application/rss+xml" href="http://www.yiiframework.com/rss.xml/" />
	<title>Special Topics: Web Service | The Definitive Guide to Yii | Yii PHP Framework</title>
	<link rel="search" type="application/opensearchdescription+xml" title="Yii API Search" href="/search-api.xml" />
	<link rel="search" type="application/opensearchdescription+xml" title="Yii Site Search" href="/search-site.xml" />
</head>

<body class="mac">
<div class="layout-main">

	<div class="layout-main-shortcuts">
		<div class="container_12">
            <a style="color:darkred;" href="https://github.com/yiisoft/yii2">Github</a> &middot;
            <a style="color:darkgreen;" href="https://twitter.com/yiiframework">Twitter</a> &middot;
            <a style="color:darkblue;" href="https://www.facebook.com/groups/yiitalk/">Facebook</a> &middot;
            <a href="/doc/guide/">Guide</a> &middot;
            <a href="/doc/api/">Class Reference</a> &middot;
            <a href="/doc-2.0/guide-index.html">Guide 2.0</a> &middot;
            <a href="/doc-2.0/index.html">API 2.0</a> &middot;
            <a href="/wiki/">Wiki</a> &middot;
            <a href="/extensions/">Extensions</a> &middot;
            <a href="/forum/">Forum</a> &middot;
			<a href="/chat/">Live Chat</a> &middot;
                            <a href="/login/">Login</a>            		</div>
	</div>

	<div class="layout-main-bg">
		<div class="layout-main-header">
			<div class="container_12">
				<div class="grid_4">
					<a class="logo" href="/"><img alt="Yii Logo" src="http://static.yiiframework.com/css/img/logo.png" title="Yii Framework" width="284" height="64" /></a>				</div>
				<div class="grid_8 omega">
					<div class="nav">
						<ul class="menu" id="yw0">
<li class="about"><a class="main" href="/about/">About</a>
<ul>
<li><a href="/about/">About Yii</a></li>
<li><a href="/features/">Features</a></li>
<li><a href="/performance/">Performance</a></li>
<li><a href="/license/">License</a></li>
<li class="last"><a href="/contact/">Contact Us</a></li>
</ul>
</li>
<li class="downloads"><a class="main" href="/download/">Downloads</a>
<ul>
<li><a href="/download/">Framework</a></li>
<li><a href="/extensions/">Extensions</a></li>
<li><a href="/demos/">Demos</a></li>
<li class="last"><a href="/logo/">Logo</a></li>
</ul>
</li>
<li class="documentation active"><a class="main" href="/doc/">Documentation</a>
<ul>
<li><a href="/tour/">Take the Tour</a></li>
<li class="active"><a href="/tutorials/">Tutorials</a></li>
<li><a href="/doc/api/">Class Reference</a></li>
<li><a href="/doc-2.0/guide-index.html">Guide 2.0</a></li>
<li><a href="/doc-2.0/index.html">Class Reference 2.0</a></li>
<li><a href="/wiki/">Wiki</a></li>
<li><a href="/screencasts/">Screencasts</a></li>
<li class="last"><a href="/resources/">Resources</a></li>
</ul>
</li>
<li class="development"><a class="main" href="https://github.com/yiisoft/yii/commits/master">Development</a>
<ul>
<li><a href="/contribute/">Contribute to Yii</a></li>
<li><a href="https://github.com/yiisoft/yii/commits/master">Latest Updates</a></li>
<li><a href="https://github.com/yiisoft/yii/issues/new">Report a Bug</a></li>
<li class="last"><a href="/security/">Report a Security Issue</a></li>
</ul>
</li>
<li class="community last"><a class="main" href="/community/">Community</a>
<ul>
<li><a href="/forum/">Forum</a></li>
<li><a href="/chat/">Live Chat</a></li>
<li><a href="/news/">News</a></li>
<li><a href="/user/halloffame/">Hall of Fame</a></li>
<li class="last"><a href="/badges/">Badges</a></li>
</ul>
</li>
</ul>						<div class="search">
							<form method="get" action="/search/">
								<div class="keyword">
	                                <input name="q" value="" />
									<a href="#" title="search" class="global-search">search</a>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="clear"></div>
			</div>
		</div>

		<div class="container_12">
						<div class="grid_12">
												<div class="layout-main-submenu">
					<ul>
						<li class="main">Documentation</li>
												<li><a href="/tour/">Take the Tour</a></li>
												<li class="active"><a href="/tutorials/">Tutorials</a></li>
												<li><a href="/doc/api/">Class Reference</a></li>
												<li><a href="/doc-2.0/guide-index.html">Guide 2.0</a></li>
												<li><a href="/doc-2.0/index.html">Class Reference 2.0</a></li>
												<li><a href="/wiki/">Wiki</a></li>
												<li><a href="/screencasts/">Screencasts</a></li>
												<li><a href="/resources/">Resources</a></li>
											</ul>
				</div>
				
				
				
									<div class="layout-main-body">
						<div class="tutorial-view">
    <div class="grid_3 alpha">
        <div class="nav-toc">
    		<div class="title">The Definitive Guide to Yii</div>
    		<div class="langver">
	            <strong>Language &amp; version</strong>
	    		<div class="languages g-dropdown">
	    		<span>English<i></i></span>
<ul>
<li><a href="/doc/guide/1.1/de/topics.webservice">Deutsch</a></li>
<li><a href="/doc/guide/1.1/es/topics.webservice">Español</a></li>
<li><a href="/doc/guide/1.1/fr/topics.webservice">Français</a></li>
<li><a href="/doc/guide/1.1/he/topics.webservice">עִבְרִית</a></li>
<li><a href="/doc/guide/1.1/id/topics.webservice">Bahasa Indonesia</a></li>
<li><a href="/doc/guide/1.1/it/topics.webservice">Italiano</a></li>
<li><a href="/doc/guide/1.1/ja/topics.webservice">日本語</a></li>
<li><a href="/doc/guide/1.1/pl/topics.webservice">Polski</a></li>
<li><a href="/doc/guide/1.1/pt/topics.webservice">Português</a></li>
<li><a href="/doc/guide/1.1/pt_br/topics.webservice">Português brasileiro</a></li>
<li><a href="/doc/guide/1.1/ro/topics.webservice">România</a></li>
<li><a href="/doc/guide/1.1/ru/topics.webservice">Русский</a></li>
<li><a href="/doc/guide/1.1/sv/topics.webservice">Svenska</a></li>
<li><a href="/doc/guide/1.1/uk/topics.webservice">украї́нська</a></li>
<li><a href="/doc/guide/1.1/zh_cn/topics.webservice">简体中文</a></li>
</ul>
	    		</div>
				<div class="versions g-dropdown">
	    		<span>1.1<i></i></span>
<ul>
<li><a href="/doc/guide/1.0/en/topics.webservice">1.0</a></li>
</ul>
				</div>
				<div class="clear"></div>
			</div>
            <div class="widget-search-box">
    <form method="get" action="/search/">
        <strong>Search in this tutorial</strong>
		<input type="text" name="q" class="keyword g-text" />
        <input type="hidden" name="type" value="guide" />
        <input type="hidden" name="lang" value="en" />
        <input type="submit" value="Find" class="btn btn-info" />
	</form>
</div>
			<ul class="toc">
						    <li class="chapter"><strong>Getting Started</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/index">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/changes">New Features</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/upgrade">Upgrading from 1.0 to 1.1</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/quickstart.what-is-yii">What is Yii</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/quickstart.installation">Installation</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/quickstart.apache-nginx-config">Apache and Nginx configurations</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/quickstart.first-app">Creating First Yii Application</a>			            </li>
			        			    						    <li class="chapter"><strong>Fundamentals</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.mvc">Model-View-Controller (MVC)</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.entry">Entry Script</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.application">Application</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.controller">Controller</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.model">Model</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.view">View</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.component">Component</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.module">Module</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.namespace">Path Alias and Namespace</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.convention">Conventions</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.workflow">Development Workflow</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/basics.best-practices">Best MVC Practices</a>			            </li>
			        			    						    <li class="chapter"><strong>Working with Forms</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.overview">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.model">Creating Model</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.action">Creating Action</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.view">Creating Form</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.table">Collecting Tabular Input</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/form.builder">Using Form Builder</a>			            </li>
			        			    						    <li class="chapter"><strong>Working with Databases</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.overview">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.dao">Database Access Objects</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.query-builder">Query Builder</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.ar">Active Record</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.arr">Relational Active Record</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/database.migration">Database Migration</a>			            </li>
			        			    						    <li class="chapter"><strong>Caching</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/caching.overview">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/caching.data">Data Caching</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/caching.fragment">Fragment Caching</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/caching.page">Page Caching</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/caching.dynamic">Dynamic Content</a>			            </li>
			        			    						    <li class="chapter"><strong>Extending Yii</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/extension.overview">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/extension.use">Using Extensions</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/extension.create">Creating Extensions</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/extension.integration">Using 3rd-Party Libraries</a>			            </li>
			        			    						    <li class="chapter"><strong>Testing</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/test.overview">Overview</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/test.fixture">Defining Fixtures</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/test.unit">Unit Testing</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/test.functional">Functional Testing</a>			            </li>
			        			    						    <li class="chapter"><strong>Special Topics</strong></li>
			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.gii">Automatic Code Generation</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.url">URL Management</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.auth">Authentication and Authorization</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.theming">Theming and Skin</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.logging">Logging</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.error">Error Handling</a>			            </li>
			        			    			        			            <li class="active">
			                &raquo; Web Service &laquo;
			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.i18n">Internationalization (I18N)</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.prado">Alternative Template Syntax</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.console">Console Applications</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.security">Security</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/topics.performance">Performance Tuning</a>			            </li>
			        			    			        			            <li>
			                <a href="/doc/guide/1.1/en/quickstart.first-app-yiic">Code Generation using Command Line Tools (deprecated)</a>			            </li>
			        			    						</ul>
        </div>
    </div>
    <div class="grid_9 omega">
    	<div class="g-markdown"><h1 id="web-service">Web Service</h1>
<div class="google-ad" style="float:right;margin:0 0 1em 1em;">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3732587985864947";
google_ad_slot = "2830391674";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<div class="toc"><ol><li><a href="#defining-service-provider">Defining Service Provider</a></li>
<li><a href="#declaring-web-service-action">Declaring Web Service Action</a></li>
<li><a href="#consuming-web-service">Consuming Web Service</a></li>
<li><a href="#data-types">Data Types</a></li>
<li><a href="#class-mapping">Class Mapping</a></li>
<li><a href="#intercepting-remote-method-invocation">Intercepting Remote Method Invocation</a></li></ol></div>


<p><a href="http://en.wikipedia.org/wiki/Web_service">Web service</a> is a software
system designed to support interoperable machine-to-machine interaction
over a network. In the context of Web applications, it usually refers to a
set of APIs that can be accessed over the Internet and executed on a remote
system hosting the requested service. For example, a
<a href="http://www.adobe.com/products/flex/">Flex</a>-based client may invoke a
function implemented on the server side running a PHP-based Web
application. Web service relies on
<a href="http://en.wikipedia.org/wiki/SOAP">SOAP</a> as its foundation layer of the
communication protocol stack.</p>

<p>Yii provides <a href="/doc/api/1.1/CWebService">CWebService</a> and <a href="/doc/api/1.1/CWebServiceAction">CWebServiceAction</a> to simplify the work of
implementing Web service in a Web application. The APIs are grouped into
classes, called <em>service providers</em>. Yii will generate for each
class a <a href="http://www.w3.org/TR/wsdl">WSDL</a> specification which describes
what APIs are available and how they should be invoked by client. When an
API is invoked by a client, Yii will instantiate the corresponding service
provider and call the requested API to fulfill the request.</p>

<blockquote class="note">
<p><strong>Note:</strong> <a href="/doc/api/1.1/CWebService">CWebService</a> relies on the <a href="http://www.php.net/manual/en/ref.soap.php">PHP SOAP
  extension</a>. Make sure you have
  enabled it before trying the examples displayed in this section.</p>
</blockquote>

<h2 id="defining-service-provider">1. Defining Service Provider <a class="anchor" href="#defining-service-provider">¶</a></h2>

<p>As we mentioned above, a service provider is a class defining the methods
that can be remotely invoked. Yii relies on <a href="http://java.sun.com/j2se/javadoc/writingdoccomments/">doc
comment</a> and <a href="http://php.net/manual/en/book.reflection.php">class
reflection</a> to
identify which methods can be remotely invoked and what are their
parameters and return value.</p>

<p>Let's start with a simple stock quoting service. This service allows a
client to request for the quote of the specified stock. We define the
service provider as follows. Note that we define the provider class
<code>StockController</code> by extending <a href="/doc/api/1.1/CController">CController</a>. This is not required.</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-reserved">class</span> <span class="hl-identifier">StockController</span> <span class="hl-reserved">extends</span> <span class="hl-identifier">CController</span>
<span class="hl-brackets">{</span>
    <span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @param </span><span class="hl-comment">string the symbol of the stock
     *</span><span class="hl-inlinedoc"> @return </span><span class="hl-comment">float the stock price
     *</span><span class="hl-inlinedoc"> @soap
</span>     <span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">getPrice</span><span class="hl-brackets">(</span><span class="hl-var">$symbol</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-var">$prices</span><span class="hl-code">=</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">IBM</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-number">100</span><span class="hl-code">, </span><span class="hl-quotes">'</span><span class="hl-string">GOOGLE</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-number">350</span><span class="hl-brackets">)</span><span class="hl-code">;
        </span><span class="hl-reserved">return</span> <span class="hl-reserved">isset</span><span class="hl-brackets">(</span><span class="hl-var">$prices</span><span class="hl-brackets">[</span><span class="hl-var">$symbol</span><span class="hl-brackets">]</span><span class="hl-brackets">)</span><span class="hl-code">?</span><span class="hl-var">$prices</span><span class="hl-brackets">[</span><span class="hl-var">$symbol</span><span class="hl-brackets">]</span><span class="hl-code">:</span><span class="hl-number">0</span><span class="hl-code">;
        </span><span class="hl-comment">//</span><span class="hl-comment">...return stock price for $symbol</span>
    <span class="hl-brackets">}</span>
<span class="hl-brackets">}</span></pre></div></div>

<p>In the above, we declare the method <code>getPrice</code> to be a Web service API by
marking it with the tag <code>@soap</code> in its doc comment. We rely on doc comment
to specify the data type of the input parameters and return value.
Additional APIs can be declared in the similar way.</p>

<h2 id="declaring-web-service-action">2. Declaring Web Service Action <a class="anchor" href="#declaring-web-service-action">¶</a></h2>

<p>Having defined the service provider, we need to make it available to
clients. In particular, we want to create a controller action to expose the
service. This can be done easily by declaring a <a href="/doc/api/1.1/CWebServiceAction">CWebServiceAction</a> action
in a controller class. For our example, we will just put it in
<code>StockController</code>.</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-reserved">class</span> <span class="hl-identifier">StockController</span> <span class="hl-reserved">extends</span> <span class="hl-identifier">CController</span>
<span class="hl-brackets">{</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">actions</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-reserved">return</span> <span class="hl-reserved">array</span><span class="hl-brackets">(</span>
            <span class="hl-quotes">'</span><span class="hl-string">quote</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
                <span class="hl-quotes">'</span><span class="hl-string">class</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">CWebServiceAction</span><span class="hl-quotes">'</span><span class="hl-code">,
            </span><span class="hl-brackets">)</span><span class="hl-code">,
        </span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span>
 
    <span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @param </span><span class="hl-comment">string the symbol of the stock
     *</span><span class="hl-inlinedoc"> @return </span><span class="hl-comment">float the stock price
     *</span><span class="hl-inlinedoc"> @soap
</span>     <span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">getPrice</span><span class="hl-brackets">(</span><span class="hl-var">$symbol</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-comment">//</span><span class="hl-comment">...return stock price for $symbol</span>
    <span class="hl-brackets">}</span>
<span class="hl-brackets">}</span></pre></div></div>

<p>That is all we need to create a Web service! If we try to access the
action by URL <code>http://hostname/path/to/index.php?r=stock/quote</code>, we will
see a lot of XML content which is actually the WSDL for the Web service we
defined.</p>

<blockquote class="tip">
<p><strong>Tip:</strong> By default, <a href="/doc/api/1.1/CWebServiceAction">CWebServiceAction</a> assumes the current controller is
  the service provider. That is why we define the <code>getPrice</code> method inside
  the <code>StockController</code> class.</p>
</blockquote>

<h2 id="consuming-web-service">3. Consuming Web Service <a class="anchor" href="#consuming-web-service">¶</a></h2>

<p>To complete the example, let's create a client to consume the Web service
we just created. The example client is written in PHP, but it could be in
other languages, such as <code>Java</code>, <code>C#</code>, <code>Flex</code>, etc.</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-var">$client</span><span class="hl-code">=</span><span class="hl-reserved">new</span> <span class="hl-identifier">SoapClient</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">http://hostname/path/to/index.php?r=stock/quote</span><span class="hl-quotes">'</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-reserved">echo</span> <span class="hl-var">$client</span><span class="hl-code">-&gt;</span><span class="hl-identifier">getPrice</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">GOOGLE</span><span class="hl-quotes">'</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div></div>

<p>Run the above script in either Web or console mode, and we shall see <code>350</code>
which is the price for <code>GOOGLE</code>.</p>

<h2 id="data-types">4. Data Types <a class="anchor" href="#data-types">¶</a></h2>

<p>When declaring class methods and properties to be remotely accessible, we
need to specify the data types of the input and output parameters. The
following primitive data types can be used:</p>

<ul>
<li>str/string: maps to <code>xsd:string</code>;</li>
<li>int/integer: maps to <code>xsd:int</code>;</li>
<li>float/double: maps to <code>xsd:float</code>;</li>
<li>bool/boolean: maps to <code>xsd:boolean</code>;</li>
<li>date: maps to <code>xsd:date</code>;</li>
<li>time: maps to <code>xsd:time</code>;</li>
<li>datetime: maps to <code>xsd:dateTime</code>;</li>
<li>array: maps to <code>xsd:string</code>;</li>
<li>object: maps to <code>xsd:struct</code>;</li>
<li>mixed: maps to <code>xsd:anyType</code>.</li>
</ul>

<p>If a type is not any of the above primitive types, it is considered as a
composite type consisting of properties. A composite type is represented in
terms of a class, and its properties are the class' public member variables
marked with <code>@soap</code> in their doc comments.</p>

<p>We can also use array type by appending <code>[]</code> to the end of a primitive or
composite type. This would specify an array of the specified type.</p>

<p>Below is an example defining the <code>getPosts</code> Web API which returns an array
of <code>Post</code> objects.</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-reserved">class</span> <span class="hl-identifier">PostController</span> <span class="hl-reserved">extends</span> <span class="hl-identifier">CController</span>
<span class="hl-brackets">{</span>
    <span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @return </span><span class="hl-comment">Post[] a list of posts
     *</span><span class="hl-inlinedoc"> @soap
</span>     <span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">getPosts</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-reserved">return</span> <span class="hl-identifier">Post</span><span class="hl-code">::</span><span class="hl-identifier">model</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">-&gt;</span><span class="hl-identifier">findAll</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span>
<span class="hl-brackets">}</span>
 
<span class="hl-reserved">class</span> <span class="hl-identifier">Post</span> <span class="hl-reserved">extends</span> <span class="hl-identifier">CActiveRecord</span>
<span class="hl-brackets">{</span>
    <span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @var </span><span class="hl-comment">integer post ID
     *</span><span class="hl-inlinedoc"> @soap
</span>     <span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-var">$id</span><span class="hl-code">;
    </span><span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @var </span><span class="hl-comment">string post title
     *</span><span class="hl-inlinedoc"> @soap
</span>     <span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-var">$title</span><span class="hl-code">;
 
    </span><span class="hl-reserved">public</span> <span class="hl-reserved">static</span> <span class="hl-reserved">function</span> <span class="hl-identifier">model</span><span class="hl-brackets">(</span><span class="hl-var">$className</span><span class="hl-code">=</span><span class="hl-reserved">__CLASS__</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-reserved">return</span> <span class="hl-identifier">parent</span><span class="hl-code">::</span><span class="hl-identifier">model</span><span class="hl-brackets">(</span><span class="hl-var">$className</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span>
<span class="hl-brackets">}</span></pre></div></div>

<h2 id="class-mapping">5. Class Mapping <a class="anchor" href="#class-mapping">¶</a></h2>

<p>In order to receive parameters of composite type from client, an
application needs to declare the mapping from WSDL types to the
corresponding PHP classes. This is done by configuring the
<a href="/doc/api/1.1/CWebServiceAction#classMap">classMap</a> property of <a href="/doc/api/1.1/CWebServiceAction">CWebServiceAction</a>.</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-reserved">class</span> <span class="hl-identifier">PostController</span> <span class="hl-reserved">extends</span> <span class="hl-identifier">CController</span>
<span class="hl-brackets">{</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">actions</span><span class="hl-brackets">(</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-reserved">return</span> <span class="hl-reserved">array</span><span class="hl-brackets">(</span>
            <span class="hl-quotes">'</span><span class="hl-string">service</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
                <span class="hl-quotes">'</span><span class="hl-string">class</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">CWebServiceAction</span><span class="hl-quotes">'</span><span class="hl-code">,
                </span><span class="hl-quotes">'</span><span class="hl-string">classMap</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
                    <span class="hl-quotes">'</span><span class="hl-string">Post</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">Post</span><span class="hl-quotes">'</span><span class="hl-code">,  </span><span class="hl-comment">//</span><span class="hl-comment"> or simply 'Post'</span>
                <span class="hl-brackets">)</span><span class="hl-code">,
            </span><span class="hl-brackets">)</span><span class="hl-code">,
        </span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span><span class="hl-code">
    ......
</span><span class="hl-brackets">}</span></pre></div></div>

<h2 id="intercepting-remote-method-invocation">6. Intercepting Remote Method Invocation <a class="anchor" href="#intercepting-remote-method-invocation">¶</a></h2>

<p>By implementing the <a href="/doc/api/1.1/IWebServiceProvider">IWebServiceProvider</a> interface, a service provider can
intercept remote method invocations. In
<a href="/doc/api/1.1/IWebServiceProvider#beforeWebMethod">IWebServiceProvider::beforeWebMethod</a>, the provider may retrieve the
current <a href="/doc/api/1.1/CWebService">CWebService</a> instance and obtain the name of the method
currently being requested via <a href="/doc/api/1.1/CWebService#methodName">CWebService::methodName</a>. It can return
false if the remote method should not be invoked for some reason (e.g.
unauthorized access).</p>

<div class="revision"><div class="google-ad" style="margin:-60px 0 5px 200px;">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-3732587985864947";
google_ad_slot = "7116172008";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>$Id$</div>
</div>
                <div class="prev-next-nav">
                            <div class="prev-topic"><a href="/doc/guide/1.1/en/topics.error">Error Handling</a></div>
                                        <div class="next-topic"><a href="/doc/guide/1.1/en/topics.i18n">Internationalization (I18N)</a></div>
                    </div>
        
		        <div class="widget-comment-list" id="comments">
	<div class="comments">
		<h3>Total 5 comments</h3>
				<div class="comment alt-0">
			<a class="cid" id="c18630" title="permalink to this comment" href="#c18630">#18630</a>
			<a class="widget-reporter" title="Please report to us if you find any inappropriate content." href="/site/report/?type=Comment&amp;id=18630"><span>report it</span></a>			<div class="widget-voter"><ul>
	<li class="vote up"><a title="Thumb up" class="g-login" href="/site/vote/?type=Comment&amp;id=18630&amp;vote=1"><span>0</span></a></li>
	<li class="vote down"><a title="Thumb down" class="g-login" href="/site/vote/?type=Comment&amp;id=18630&amp;vote=0"><span>0</span></a></li>
</ul>
<div class="clear"></div></div>			<div class="meta"><a class="g-user-rank-link" href="/user/236264/">designpromote.co.uk</a> at 2014/12/03 07:25pm</div>
			<div class="title">XML Parsing Error: junk after document element</div>
			<div class="content"><p>if you have those errors:</p>

<p>XML Parsing Error: junk after document element
Location: http://127.0.0.1/index.php?r=api/quote
Line Number 35, Column 1:</p>

<p>&lt;</p>

<p>table class="yiiLog" width="100%" cellpadding="2" style="border-spacing:1px;font:11px Verdana, Arial, Helvetica, sans-serif;background:#EEEEEE;color:#666666;"&gt;
^</p>

<p>You should comment debug mode in index.php</p>

<p>//defined('YII_DEBUG') or define('YII_DEBUG',true);</p>
</div>
					</div>
				<div class="comment alt-1">
			<a class="cid" id="c8107" title="permalink to this comment" href="#c8107">#8107</a>
			<a class="widget-reporter" title="Please report to us if you find any inappropriate content." href="/site/report/?type=Comment&amp;id=8107"><span>report it</span></a>			<div class="widget-voter"><ul>
	<li class="vote up"><a title="Thumb up" class="g-login" href="/site/vote/?type=Comment&amp;id=8107&amp;vote=1"><span>4</span></a></li>
	<li class="vote down"><a title="Thumb down" class="g-login" href="/site/vote/?type=Comment&amp;id=8107&amp;vote=0"><span>0</span></a></li>
</ul>
<div class="clear"></div></div>			<div class="meta"><a class="g-user-rank-link bronze" href="/user/48374/">bluyell</a> at 2012/05/10 01:06pm</div>
			<div class="title">Function (&quot;getNewFunction&quot;) is not a valid method for this service</div>
			<div class="content"><p>if you use the main wiki example then all is working fine, but if you add a new function on Ws controller then on client side this error is shown:</p>

<p><strong>Function ("getNewFunction") is not a valid method for this service</strong></p>

<p>i found the solution on <a href="http://www.yiiframework.com/forum/index.php?/topic/20505-solved-masalah-akses-soap/page__view__findpost__p__100355__hl__Function++i+not+a+valid+method+for+thi++ervice" title="this post">this post</a> but is not in english, so, here is the solution in english language:</p>

<p>to avoid this error when new function were added to the web service then add
this two lines on your client side ws consumer (before you call "new SoapClient.."):</p>

<p>ini_set (  'soap.wsdl_cache_enable'  ,  0  ); 
ini_set (  'soap.wsdl_cache_ttl'  ,  0  );</p>
</div>
					</div>
				<div class="comment alt-0">
			<a class="cid" id="c6656" title="permalink to this comment" href="#c6656">#6656</a>
			<a class="widget-reporter" title="Please report to us if you find any inappropriate content." href="/site/report/?type=Comment&amp;id=6656"><span>report it</span></a>			<div class="widget-voter"><ul>
	<li class="vote up"><a title="Thumb up" class="g-login" href="/site/vote/?type=Comment&amp;id=6656&amp;vote=1"><span>0</span></a></li>
	<li class="vote down"><a title="Thumb down" class="g-login" href="/site/vote/?type=Comment&amp;id=6656&amp;vote=0"><span>0</span></a></li>
</ul>
<div class="clear"></div></div>			<div class="meta"><a class="g-user-rank-link" href="/user/51243/">zvik2004</a> at 2012/01/25 04:40pm</div>
			<div class="title">SOAP partially works (when enableCsrfValidation is true)</div>
			<div class="content"><p>I used the example as specified in this page.<br />
The http://hostname/path/to/index.php/stock/quote showed me the xml, but I failed to invoke the getPrice operation.<br />
When examining the result I saw that the result contained:</p>

<p>Error 400...<br />
The CSRF token could not be verified.</p>

<p>This was because enableCsrfValidation was set to true in /protected/config/main.php:</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-quotes">'</span><span class="hl-string">request</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
    <span class="hl-quotes">'</span><span class="hl-string">enableCookieValidation</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">true</span><span class="hl-code">,
</span><span class="hl-brackets">)</span><span class="hl-code">,</span></pre></div></div>

<p><a href="http://creative-territory.net/post/view/id/25/" title="Here is">Here is</a> a solution for this problem.<br />
Thanks to <a href="http://www.yiiframework.com/forum/index.php?/user/1147-angel-de-la-noche/" title="Angel De La Noche">Angel De La Noche</a> for pointing me there.</p>
</div>
					</div>
				<div class="comment alt-1">
			<a class="cid" id="c3490" title="permalink to this comment" href="#c3490">#3490</a>
			<a class="widget-reporter" title="Please report to us if you find any inappropriate content." href="/site/report/?type=Comment&amp;id=3490"><span>report it</span></a>			<div class="widget-voter"><ul>
	<li class="vote up"><a title="Thumb up" class="g-login" href="/site/vote/?type=Comment&amp;id=3490&amp;vote=1"><span>2</span></a></li>
	<li class="vote down"><a title="Thumb down" class="g-login" href="/site/vote/?type=Comment&amp;id=3490&amp;vote=0"><span>0</span></a></li>
</ul>
<div class="clear"></div></div>			<div class="meta"><a class="g-user-rank-link" href="/user/147/">jwerner</a> at 2011/04/15 03:56am</div>
			<div class="title">Consuming Web Service</div>
			<div class="content"><p>if you have enabled the URL manager in <em>config/main.php</em> like this:</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-code">...
</span><span class="hl-quotes">'</span><span class="hl-string">urlManager</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
    <span class="hl-quotes">'</span><span class="hl-string">urlFormat</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">path</span><span class="hl-quotes">'</span><span class="hl-code">,
    </span><span class="hl-quotes">'</span><span class="hl-string">rules</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-reserved">array</span><span class="hl-brackets">(</span>
        <span class="hl-quotes">'</span><span class="hl-string">&lt;controller:\w+&gt;/&lt;id:\d+&gt;</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">&lt;controller&gt;/view</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-quotes">'</span><span class="hl-string">&lt;controller:\w+&gt;/&lt;action:\w+&gt;/&lt;id:\d+&gt;</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">&lt;controller&gt;/&lt;action&gt;</span><span class="hl-quotes">'</span><span class="hl-code">,
        </span><span class="hl-quotes">'</span><span class="hl-string">&lt;controller:\w+&gt;/&lt;action:\w+&gt;</span><span class="hl-quotes">'</span><span class="hl-code">=&gt;</span><span class="hl-quotes">'</span><span class="hl-string">&lt;controller&gt;/&lt;action&gt;</span><span class="hl-quotes">'</span><span class="hl-code">,
...</span></pre></div></div>

<p>then you need to write the SOAP URL like this:</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-var">$client</span><span class="hl-code">=</span><span class="hl-reserved">new</span> <span class="hl-identifier">SoapClient</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">http://hostname/path/to/index.php/stock/quote</span><span class="hl-quotes">'</span><span class="hl-brackets">)</span><span class="hl-code">;
</span><span class="hl-comment">//</span><span class="hl-comment">                                                     ^^^^        </span>
<span class="hl-reserved">echo</span> <span class="hl-var">$client</span><span class="hl-code">-&gt;</span><span class="hl-identifier">getPrice</span><span class="hl-brackets">(</span><span class="hl-quotes">'</span><span class="hl-string">GOOGLE</span><span class="hl-quotes">'</span><span class="hl-brackets">)</span><span class="hl-code">;</span></pre></div></div>

<p>Hope this helps.</p>
</div>
					</div>
				<div class="comment alt-0">
			<a class="cid" id="c1945" title="permalink to this comment" href="#c1945">#1945</a>
			<a class="widget-reporter" title="Please report to us if you find any inappropriate content." href="/site/report/?type=Comment&amp;id=1945"><span>report it</span></a>			<div class="widget-voter"><ul>
	<li class="vote up"><a title="Thumb up" class="g-login" href="/site/vote/?type=Comment&amp;id=1945&amp;vote=1"><span>2</span></a></li>
	<li class="vote down"><a title="Thumb down" class="g-login" href="/site/vote/?type=Comment&amp;id=1945&amp;vote=0"><span>0</span></a></li>
</ul>
<div class="clear"></div></div>			<div class="meta"><a class="g-user-rank-link silver" href="/user/2584/">zaccaria</a> at 2010/10/18 09:57am</div>
			<div class="title">hosting not supporting SOAP</div>
			<div class="content"><p>If your host is not supporting SOAP, you can use a controller instead.</p>

<p>You can use an action for each function and encpsulate the result with json:</p>

<div class="hl-code"><div class="hl-main"><pre><span class="hl-comment">/*</span><span class="hl-comment">*
     *</span><span class="hl-inlinedoc"> @param </span><span class="hl-comment">string the symbol of the stock
     *</span><span class="hl-inlinedoc"> @return </span><span class="hl-comment">float the stock price
     </span><span class="hl-comment">*/</span>
    <span class="hl-reserved">public</span> <span class="hl-reserved">function</span> <span class="hl-identifier">actionGetPrice</span><span class="hl-brackets">(</span><span class="hl-var">$symbol</span><span class="hl-brackets">)</span>
    <span class="hl-brackets">{</span>
        <span class="hl-identifier">CJSON</span><span class="hl-code">::</span><span class="hl-identifier">encode</span><span class="hl-brackets">(</span><span class="hl-var">$symbol</span><span class="hl-brackets">)</span><span class="hl-code">;
    </span><span class="hl-brackets">}</span></pre></div></div>

<p>This is an acceptable workaround. Of corse there are no type check, and the result is not in xml but a JSON encoded, but this system at least allow 2 application to collaborate.</p>
</div>
					</div>
			</div>
	<div id="comment-add">
		<h3 id="add-comment">Leave a comment</h3>

			<p>Please <a class="g-login" rel="/doc/guide/1.1/en/topics.webservice#add-comment" href="#">login</a> to leave your comment.</p>
		</div>
</div>
           </div>
</div>
					</div>
				
								<div class="clear"></div>
			</div>
			<div class="clear"></div>
					</div>
	</div>

	<div class="layout-main-footer">
		<div class="container_12">
			<div class="grid_6">
				<ul class="menu">
				<li class="main">About
<ul class="sub">
<li><a href="/about/">About Yii</a></li>
<li><a href="/features/">Features</a></li>
<li><a href="/performance/">Performance</a></li>
<li><a href="/license/">License</a></li>
<li><a href="/contact/">Contact Us</a></li>
</ul>
</li>
<li class="main">Downloads
<ul class="sub">
<li><a href="/download/">Framework</a></li>
<li><a href="/extensions/">Extensions</a></li>
<li><a href="/demos/">Demos</a></li>
<li><a href="/logo/">Logo</a></li>
</ul>
</li>
<li class="main">Documentation
<ul class="sub">
<li><a href="/tour/">Take the Tour</a></li>
<li><a href="/tutorials/">Tutorials</a></li>
<li><a href="/doc/api/">Class Reference</a></li>
<li><a href="/doc-2.0/guide-index.html">Guide 2.0</a></li>
<li><a href="/doc-2.0/index.html">Class Reference 2.0</a></li>
<li><a href="/wiki/">Wiki</a></li>
<li><a href="/screencasts/">Screencasts</a></li>
<li><a href="/resources/">Resources</a></li>
</ul>
</li>
<li class="main">Development
<ul class="sub">
<li><a href="/contribute/">Contribute to Yii</a></li>
<li><a href="https://github.com/yiisoft/yii/commits/master">Latest Updates</a></li>
<li><a href="https://github.com/yiisoft/yii/issues/new">Report a Bug</a></li>
<li><a href="/security/">Report a Security Issue</a></li>
</ul>
</li>
<li class="main">Community
<ul class="sub">
<li><a href="/forum/">Forum</a></li>
<li><a href="/chat/">Live Chat</a></li>
<li><a href="/news/">News</a></li>
<li><a href="/user/halloffame/">Hall of Fame</a></li>
<li><a href="/badges/">Badges</a></li>
</ul>
</li>
				</ul>
			</div>
			<div class="grid_1">&nbsp;</div>
			<div class="grid_5">
				<h3>Yii Supporters</h3>
				<ul class="g-list-none supporters">

				</ul>
			</div>

			<div class="clear"></div>
			<div class="grid_12 copyright">
				<ul class="social">
					<li class="twitter"><a href="https://twitter.com/yiiframework" target="_blank" rel="nofollow" title="follow us on twitter">Twitter</a></li>
					<li class="facebook"><a href="https://www.facebook.com/groups/yiitalk/" target="_blank" rel="nofollow" title="join yii group at facebook">Facebook</a></li>
					<li class="linkedin"><a href="http://www.linkedin.com/groups?gid=1483367" target="_blank" rel="nofollow" title="join yii group at linkedin">LinkedIn</a></li>
					<li class="feeds"><a title="RSS feeds" href="/rss.xml/">RSS Feeds</a></li>
				</ul>
				<div class="clear"></div>
				<a href="/tos/">Terms of Service</a> |
				<a href="/license/">License</a> |
				<a href="/contact/">Contact Us</a><br/>
				Copyright &copy; 2015 by <a href="http://www.yiisoft.com">Yii Software LLC</a>.
				All Rights Reserved.
			</div>
			<div class="clear"></div>
		</div>
	</div>
</div>

    <script type="text/javascript" src="/js/site-20121004195728.js"></script>


<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['site._setAccount', 'UA-5843896-1']);
_gaq.push(['site._trackPageview']);

(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script type="text/javascript">
function trackClick(link, action, category) {
	action=action || link.href;
	category=category || 'Outbound Links';
	try {
		_gaq.push(['site._trackEvent', category, action]);
		setTimeout('document.location = "' + link.href + '"', 250);
	}catch(err){}
	return false;
}
</script>
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
</body>
</html>
